<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–°–∏–º—É–ª—è—Ç–æ—Ä –†–æ–¥–∏—Ç–µ–ª—è: –ö–∞—Ä—å–µ—Ä–∞</title>
    <style>
        body { 
            display: flex; 
            flex-direction: column; 
            justify-content: center; 
            align-items: center; 
            height: 100vh; 
            margin: 0; 
            background-color: #f0f0f0; 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            overflow: hidden; 
            user-select: none; 
            -webkit-user-select: none;
            transition: background-color 0.5s ease;
        }

        /* –í–µ—Ä—Ö–Ω—è—è –∏–Ω—Ñ–æ-–ø–∞–Ω–µ–ª—å */
        .top-panel {
            position: absolute;
            top: 20px;
            left: 20px;
            text-align: left;
        }
        .level-badge {
            background: #333;
            color: #fff;
            padding: 5px 15px;
            border-radius: 15px;
            font-weight: bold;
            font-size: 14px;
            margin-bottom: 5px;
            display: inline-block;
        }

        .cradle-container {
            position: relative;
            margin-bottom: 20px;
            overflow: visible; /* –ß—Ç–æ–±—ã —á–∞—Å—Ç–∏—Ü—ã –ª–µ—Ç–µ–ª–∏ –≤—ã—Å–æ–∫–æ */
        }

        .cradle { 
            width: 220px; 
            height: 220px; 
            background-color: #fff; 
            border-radius: 50%; 
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            cursor: pointer;
            border: 8px solid #e0e0e0;
            position: relative;
            z-index: 2;
            transition: transform 0.1s; 
        }

        .cradle:active { transform: scale(0.95); }

        .swinging { animation: swing 2s ease-in-out forwards; }

        @keyframes swing {
            0% { transform: rotate(0deg); }
            20% { transform: rotate(-10deg); }
            40% { transform: rotate(8deg); }
            60% { transform: rotate(-4deg); }
            80% { transform: rotate(2deg); }
            100% { transform: rotate(0deg); }
        }

        .cradle img { 
            width: 140px; 
            height: 140px; 
            object-fit: contain; 
            pointer-events: none;
        }

        /* –¢–∞–π–º–µ—Ä –∏ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
        .game-stats { 
            margin-bottom: 20px; 
            text-align: center;
        }
        .timer-big {
            font-size: 48px;
            font-weight: 900;
            color: #333;
            line-height: 1;
        }
        .timer-label {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }
        .goal-text {
            font-size: 14px;
            color: #4CAF50;
            font-weight: bold;
            margin-top: 5px;
        }

        .status-bar {
            width: 85%;
            max-width: 350px;
            height: 24px;
            background-color: #e0e0e0;
            border-radius: 12px;
            margin-bottom: 30px;
            overflow: hidden;
            border: 2px solid #ccc;
        }

        .anxiety-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #4CAF50, #81C784);
            transition: width 0.3s cubic-bezier(0.25, 0.1, 0.25, 1), background 0.5s;
        }

        .action-button { 
            padding: 18px 50px; 
            font-size: 20px; 
            font-weight: bold;
            color: white; 
            border: none; 
            border-radius: 50px; 
            cursor: pointer; 
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
            background-color: #4CAF50; 
            transition: transform 0.1s;
            text-transform: uppercase;
        }
        .action-button:active { transform: scale(0.95); }

        #soundToggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.8);
            border-radius: 50%;
            width: 44px;
            height: 44px;
            border: none;
            font-size: 20px;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        /* --- –ß–ê–°–¢–ò–¶–´ --- */
        .particle {
            position: absolute;
            pointer-events: none;
            animation: floatUp 1s ease-out forwards;
            font-size: 32px;
            z-index: 10; 
            text-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        @keyframes floatUp {
            0% { transform: translateY(-20px) scale(0.5) rotate(0deg); opacity: 1; }
            100% { transform: translateY(-200px) scale(1.5) rotate(45deg); opacity: 0; }
        }
    </style>
</head>
<body>

    <div class="top-panel">
        <div class="level-badge" id="levelBadge">–£—Ä–æ–≤–µ–Ω—å 1</div>
    </div>
    
    <button id="soundToggle">üîä</button> 

    <div class="game-stats">
        <div class="timer-big" id="timer">00:00</div>
        <div class="timer-label">–û—Å—Ç–∞–ª–æ—Å—å –≤—Ä–µ–º–µ–Ω–∏</div>
        <div class="goal-text" id="goalText">–ù—É–∂–Ω–æ —Ç–∏—à–∏–Ω—ã: 30 —Å–µ–∫</div>
    </div>
    
    <div class="status-bar">
        <div class="anxiety-fill" id="anxietyBar"></div>
    </div>

    <div class="cradle-container">
        <div class="cradle" id="cradle" style="pointer-events: none; opacity: 0.8;">
            <img id="baby" src="baby_happy.png" alt="Baby">
        </div>
    </div>

    <button class="action-button" id="mainActionButton">–ù–∞—á–∞—Ç—å –ò–≥—Ä—É</button>

    <script>
        /* --- –ó–í–£–ö–ò --- */
        let isSoundOn = true;
        const soundHappy = new Audio('happy.mp3');
        const soundCrying = new Audio('crying.mp3');
        soundCrying.loop = true; 
        const soundRock = new Audio('rock_cradle.mp3');

        function playSound(audioObject) {
            if (isSoundOn) {
                audioObject.currentTime = 0;
                audioObject.play().catch(e => {});
            }
        }
        function stopSound(audioObject) {
            audioObject.pause();
            audioObject.currentTime = 0;
        }
        document.getElementById('soundToggle').addEventListener('click', function() {
            isSoundOn = !isSoundOn;
            this.textContent = isSoundOn ? 'üîä' : 'üîá';
            if (!isSoundOn) stopSound(soundCrying);
            else if (anxietyLevel >= 50) playSound(soundCrying);
        });

        /* --- –ù–ê–°–¢–†–û–ô–ö–ò –£–†–û–í–ù–ï–ô --- */
        const LEVELS = [
            { id: 1, speed: 2, maxLimit: 8, name: "–ü–µ—Ä–≤—ã–π –¥–µ–Ω—å –û—Ç–µ—Ü" },
            { id: 2, speed: 4, maxLimit: 12, name: "–û–ø—ã—Ç–Ω—ã–π" },
            { id: 3, speed: 6, maxLimit: 16, name: "–ü—Ä–æ—Ñ–∏" },
            { id: 4, speed: 8, maxLimit: 20, name: "–í–µ—Ç–µ—Ä–∞–Ω" },
            { id: 5, speed: 10, maxLimit: 25, name: "–û—Ç–µ—Ü –î—Ä–∞–∫–æ–Ω–∞" },
            { id: 6, speed: 15, maxLimit: 40, name: "–ë–û–ì –†–û–î–ò–¢–ï–õ–¨–°–¢–í–ê" }
        ];

        /* --- –§–†–ê–ó–´ --- */
        const FAIL_PHRASES = [
            "–õ—É—á—à–µ –∑–∞–≤–µ–¥–∏—Ç–µ —Ñ–∏–∫—É—Å. –û–Ω –º–æ–ª—á–∏—Ç.",
            "–ù–∞—á–Ω–∏—Ç–µ —Å —Ç–∞–º–∞–≥–æ—á–∏, –æ–Ω —Ö–æ—Ç—è –±—ã –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è.",
            "–°–æ—Å–µ–¥–∏ –≤—ã–∑–≤–∞–ª–∏ –æ–ø–µ–∫—É. –ò —Å–ø–µ—Ü–Ω–∞–∑.",
            "–ö–∞–∂–µ—Ç—Å—è, –ø–ª—é—à–µ–≤—ã–π –º–∏—à–∫–∞ –≤–∞–º –ø–æ–¥–æ–π–¥–µ—Ç –±–æ–ª—å—à–µ.",
            "–ö–æ—à–∫–∞ –±—ã —Å–ø—Ä–∞–≤–∏–ª–∞—Å—å –ª—É—á—à–µ...",
            "–ù–µ —Ä–∞—Å—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ—Å—å, –≤—Å–µ–≥–¥–∞ –º–æ–∂–Ω–æ –Ω–∞–Ω—è—Ç—å –Ω—è–Ω—é! –î–∞—Ç—å —Ç–µ–ª–µ—Ñ–æ–Ω?"
        ];

        const WIN_PHRASES = [
            "–í—ã–∂–∏–ª–∏! –ù–æ —ç—Ç–æ —Ç–æ–ª—å–∫–æ –Ω–∞—á–∞–ª–æ...",
            "–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! –†–µ–±–µ–Ω–æ–∫ –ø–æ—á—Ç–∏ –Ω–µ –∑–∞–º–µ—Ç–∏–ª –ø–æ–¥–≤–æ—Ö–∞.",
            "–í—ã –Ω–∞—Å—Ç–æ—è—â–∏–π –∑–∞–∫–ª–∏–Ω–∞—Ç–µ–ª—å –º–ª–∞–¥–µ–Ω—Ü–µ–≤!",
            "–£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–π–¥–µ–Ω! –°–æ—Å–µ–¥–∏ –ø–æ–¥–æ–∑—Ä–µ–≤–∞—é—Ç —á—Ç–æ –≤—ã –∫—É–¥–∞-—Ç–æ –¥–µ–ª–∏ —Ä–µ–±–µ–Ω–∫–∞.",
            "–í–∞—à–∏ –Ω–µ—Ä–≤—ã –∫—Ä–µ–ø—á–µ —Å—Ç–∞–ª–∏!",
            "–≠–¢–û –ë–´–õ–û –õ–ï–ì–ï–ù–î–ê–†–ù–û!"
        ];

        /* --- –ü–ï–†–ï–ú–ï–ù–ù–´–ï --- */
        let currentLevelIndex = 0;
        let anxietyLevel = 0;
        let levelTimeSeconds = 0; // –í—Ä–µ–º—è –ø—Ä–æ—à–µ–¥—à–µ–µ –≤ —É—Ä–æ–≤–Ω–µ
        let calmTimeInLevel = 0; // –í—Ä–µ–º—è —Ç–∏—à–∏–Ω—ã –≤ —É—Ä–æ–≤–Ω–µ
        
        let timerInterval;
        let isCrying = false;
        let isGameRunning = false;
        let currentAnxietyGain = 0; 
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã
        const cradle = document.getElementById('cradle');
        const baby = document.getElementById('baby');
        const timerDisplay = document.getElementById('timer');
        const goalText = document.getElementById('goalText');
        const levelBadge = document.getElementById('levelBadge');
        const mainActionButton = document.getElementById('mainActionButton');
        const anxietyBar = document.getElementById('anxietyBar');
        const body = document.body;
        const cradleContainer = document.querySelector('.cradle-container');

        /* --- –ß–ê–°–¢–ò–¶–´ --- */
        function createParticles() {
            const particle = document.createElement('div');
            particle.classList.add('particle');
            const emojis = anxietyLevel < 50 ? ['‚ù§Ô∏è', '‚ú®', 'üí§', 'üë∂'] : ['üí¶', 'üí¢', '‚ö°Ô∏è', 'üò≠'];
            particle.textContent = emojis[Math.floor(Math.random() * emojis.length)];
            const offsetX = (Math.random() - 0.5) * 80;
            const offsetY = (Math.random() - 0.5) * 80;
            particle.style.left = `calc(50% + ${offsetX}px)`;
            particle.style.top = `calc(50% + ${offsetY}px)`;
            cradleContainer.appendChild(particle);
            setTimeout(() => particle.remove(), 1000);
        }

        /* --- –û–ë–ù–û–í–õ–ï–ù–ò–ï --- */
        function updateUI() {
            // –ü–æ–ª–æ—Å–∫–∞
            anxietyBar.style.width = anxietyLevel + "%";
            
            // –°–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–µ–±–µ–Ω–∫–∞ –∏ —Ñ–æ–Ω
            if (anxietyLevel < 50) {
                baby.src = "baby_happy.png"; 
                body.style.backgroundColor = "#e8f5e9";
                anxietyBar.style.background = "linear-gradient(90deg, #4CAF50, #81C784)";
                if (isCrying) { stopSound(soundCrying); playSound(soundHappy); isCrying = false; }
            } else {
                baby.src = "baby_crying.png"; 
                body.style.backgroundColor = "#ffebee";
                anxietyBar.style.background = "linear-gradient(90deg, #d32f2f, #ef5350)";
                if (!isCrying) { playSound(soundCrying); isCrying = true; }
            }
        }

        function updateTimer() {
            levelTimeSeconds++;

            // –°—á–∏—Ç–∞–µ–º —Ç–∏—à–∏–Ω—É
            if (anxietyLevel < 50) {
                calmTimeInLevel++;
            }

            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç
            const timeLeft = 60 - levelTimeSeconds;
            timerDisplay.textContent = `00:${timeLeft.toString().padStart(2, '0')}`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ü–µ–ª—å (—Å–∫–æ–ª—å–∫–æ –µ—â–µ –Ω—É–∂–Ω–æ —Ç–∏—à–∏–Ω—ã)
            const calmNeeded = Math.max(0, 30 - calmTimeInLevel);
            if (calmNeeded === 0) {
                goalText.textContent = "–¶–ï–õ–¨ –í–´–ü–û–õ–ù–ï–ù–ê! (–î–µ—Ä–∂–∏—Ç–µ—Å—å –¥–æ –∫–æ–Ω—Ü–∞)";
                goalText.style.color = "#2196F3";
            } else {
                goalText.textContent = `–ù—É–∂–Ω–æ —Ç–∏—à–∏–Ω—ã: –µ—â–µ ${calmNeeded} —Å–µ–∫`;
                goalText.style.color = "#4CAF50";
            }

            // –ü–†–û–í–ï–†–ö–ê –ö–û–ù–¶–ê –£–†–û–í–ù–Ø (60 —Å–µ–∫—É–Ω–¥ –ø—Ä–æ—à–ª–æ)
            if (levelTimeSeconds >= 60) {
                finishLevel();
            }
        }

        /* --- –ö–õ–ò–ö --- */
        cradle.addEventListener('click', () => {
            if (!isGameRunning) return;

            playSound(soundRock); 
            anxietyLevel = Math.max(0, anxietyLevel - 15); // –ö–ª–∏–∫ —Å–Ω–∏–º–∞–µ—Ç 15 —Å—Ç—Ä–µ—Å—Å–∞
            
            // –£—Å–∫–æ—Ä—è–µ–º, –Ω–æ –Ω–µ –≤—ã—à–µ –ª–∏–º–∏—Ç–∞ —Ç–µ–∫—É—â–µ–≥–æ —É—Ä–æ–≤–Ω—è
            currentAnxietyGain *= 2; 
            const maxForLevel = LEVELS[currentLevelIndex].maxLimit;
            currentAnxietyGain = Math.min(maxForLevel, currentAnxietyGain);

            cradle.classList.remove('swinging');
            void cradle.offsetWidth; 
            cradle.classList.add('swinging');

            createParticles();
            createParticles();
            updateUI();
        });

        /* --- –£–ü–†–ê–í–õ–ï–ù–ò–ï –£–†–û–í–ù–Ø–ú–ò --- */
        function startLevel() {
            // –°–±—Ä–æ—Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è —É—Ä–æ–≤–Ω—è
            const levelConfig = LEVELS[currentLevelIndex];
            
            levelBadge.textContent = `–£—Ä–æ–≤–µ–Ω—å ${levelConfig.id}: ${levelConfig.name}`;
            currentAnxietyGain = levelConfig.speed; // –ù–∞—á–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —É—Ä–æ–≤–Ω—è
            anxietyLevel = 0;
            levelTimeSeconds = 0;
            calmTimeInLevel = 0;
            
            isGameRunning = true;
            isCrying = false;
            
            cradle.style.pointerEvents = 'auto'; 
            cradle.style.opacity = '1';
            mainActionButton.style.display = 'none'; // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –≤–æ –≤—Ä–µ–º—è –∏–≥—Ä—ã

            updateUI();
            
            timerInterval = setInterval(() => {
                // –†–∞—Å—Ç–µ–º –ø–æ —Ç–µ–∫—É—â–µ–π —Å–∫–æ—Ä–æ—Å—Ç–∏
                anxietyLevel = Math.min(100, anxietyLevel + currentAnxietyGain); 
                updateUI();
                updateTimer();
            }, 1000);
        }

        function finishLevel() {
            clearInterval(timerInterval);
            isGameRunning = false;
            stopSound(soundCrying);
            cradle.style.pointerEvents = 'none';
            cradle.style.opacity = '0.8';
            mainActionButton.style.display = 'block';

            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—Ö–∞
            if (calmTimeInLevel >= 30) {
                // –ü–û–ë–ï–î–ê
                const msg = WIN_PHRASES[Math.floor(Math.random() * WIN_PHRASES.length)];
                alert(`üéâ –£–†–û–í–ï–ù–¨ ${LEVELS[currentLevelIndex].id} –ü–†–û–ô–î–ï–ù!\n\n–¢–∏—à–∏–Ω–∞: ${calmTimeInLevel} —Å–µ–∫.\n${msg}`);
                
                // –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —É—Ä–æ–≤–Ω—é
                currentLevelIndex++;
                if (currentLevelIndex >= LEVELS.length) {
                    alert("üèÜ –í–´ –ü–†–û–®–õ–ò –í–°–Æ –ò–ì–†–£!\n–í—ã –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ –û—Ç–µ—Ü –ì–æ–¥–∞ 2025!");
                    currentLevelIndex = 0; // –ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ
                    mainActionButton.textContent = "–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ";
                } else {
                    mainActionButton.textContent = `–ù–∞—á–∞—Ç—å —É—Ä–æ–≤–µ–Ω—å ${currentLevelIndex + 1}`;
                }
            } else {
                // –ü–û–†–ê–ñ–ï–ù–ò–ï
                const msg = FAIL_PHRASES[Math.floor(Math.random() * FAIL_PHRASES.length)];
                alert(`üíÄ –ü–†–û–í–ê–õ!\n\n–¢–∏—à–∏–Ω–∞ –±—ã–ª–∞ –≤—Å–µ–≥–æ ${calmTimeInLevel} —Å–µ–∫ (–Ω—É–∂–Ω–æ 30).\n${msg}`);
                // –û—Å—Ç–∞–µ–º—Å—è –Ω–∞ —Ç–æ–º –∂–µ —É—Ä–æ–≤–Ω–µ –∏–ª–∏ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º? –ü—É—Å—Ç—å –æ—Å—Ç–∞–µ—Ç—Å—è.
                mainActionButton.textContent = "–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞";
            }
        }

        mainActionButton.addEventListener('click', () => {
            startLevel();
        });

    </script>
</body>
</html>